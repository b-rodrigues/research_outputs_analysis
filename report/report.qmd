---
title: "Research Publications Affiliated with Luxembourg: A Data-Driven Analysis"
page-layout: full
format:
  html:
    toc: true
    toc-depth: 3
    number-sections: true
    embed-resources: true
---

```{r}
#| include: false
library(DT)
library(crosstalk)
library(dplyr)
library(ggplot2)
library(rixpress)
library(tidyr)

rxp_load("type_doi_missing")
rxp_load("lu_first_authors")
rxp_load("primary_domain_lu")
rxp_load("country_authors_unique")
```

## Introduction

This report presents a comprehensive analysis of Luxembourg's research
publication landscape using data extracted from OpenAlex, an open-access
scholarly metadata platform. OpenAlex serves as a freely accessible alternative
to proprietary academic databases, providing structured information about
publications, authors, institutional affiliations, and research collaborations
across all academic disciplines.

The data collection methodology focuses on identifying all scholarly works with
Luxembourg institutional affiliations recorded in OpenAlex over the past decade.
This approach captures both research led by Luxembourg-based scholars and
international collaborative projects where Luxembourg institutions participate
as co-authors. The temporal scope provides a current snapshot of the country's
scientific output and evolving research partnerships.

OpenAlex aggregates metadata from multiple sources including institutional
repositories, publisher databases, and citation networks. While this
multi-source approach enhances coverage comprehensiveness, data quality depends
on the accuracy of source reporting and the platform's ability to correctly
identify and link Luxembourg-affiliated works. These methodological
considerations should be kept in mind when interpreting the analytical findings
presented throughout this report.

## Data Structure and Document Types

The initial dataset encompasses all document types recorded in OpenAlex for
Luxembourg-affiliated scholarly works during the study period. The following
table displays the distribution of work types and the presence of Digital Object
Identifiers (DOIs), which serve as persistent identifiers linking to original
publications:

```{r}
#| echo: false
#| label: tbl-type-doi-missing
#| tbl-cap: Distribution of types of work and missingness of DOI

datatable(
  type_doi_missing,
  caption = "Distribution of types of work and missingness of DOI",
  options = list(
    pageLength = 15,
    scrollX = TRUE,
    dom = 'Bfrtip',
    buttons = c('excel')
  ),
  extensions = 'Buttons'
)
```

Based on the substantial predominance of journal articles in the dataset and
their central importance in academic research communication, this analysis
restricts its focus to articles exclusively. This selection encompasses both
publications with DOI identifiers and those without, ensuring comprehensive
coverage of Luxembourg's peer-reviewed research output.

The analytical framework employs a critical distinction based on first authorship status: whether the primary author maintains affiliation with a Luxembourg institution or represents an international collaboration where Luxembourg institutions participate as secondary contributors. This classification enables differentiation between research leadership and research participation within the national research ecosystem:

```{r}
#| echo: false
#| label: tbl-lu-first-authors
#| tbl-cap: Number of articles where the first author is LU-affiliated

lu_first_authors <- lu_first_authors %>%
  pivot_wider(names_from = is_lu_first_author, values_from = total) %>%
  rename(
  `Publication Year` = publication_year,
  `Non-LU first author` = `FALSE`,
  `LU first author` = `TRUE`
)

lu_first_authors_shared <- SharedData$new(lu_first_authors)

# Year filter widget
filter_slider(id = "publication_year_filter", label = "Select Year Range:",
              sharedData = lu_first_authors_shared, column = "Publication Year",
              step = 1, round = TRUE, width = "100%")

datatable(
  lu_first_authors_shared,
  filter = "top",
  caption = "Number of articles where the first author is LU-affiliated",
  options = list(
    pageLength = 10,
    scrollX = TRUE,
    dom = 'Bfrtip',
    buttons = c('excel'),
    order = list(list(0, 'desc'))
  ),
  extensions = 'Buttons'
) %>%
  formatStyle(columns = colnames(.), fontsize = '12px')
```

## Research Domain Analysis

The following visualization examines the temporal distribution of
Luxembourg-affiliated research across major scientific domains. The data
utilizes OpenAlex's domain classification system, which categorizes research
fields into broad disciplinary areas. The analysis tracks publication volumes
over time while maintaining the distinction between Luxembourg-led research
(first author affiliation) and collaborative research (non-first author
participation):

```{r}
#| echo: false
#| fig-height: 6
#| fig-width: 12

domain_colors <- c(
  # Add your actual domain names here with distinctive colors
  "Health Sciences" = "#FF6B35",        # Orange-red
  "Life Sciences" = "#003399",      # Deep blue
  "MISSING-DOMAIN" = "#228B22",   # Forest green
  "Physical Sciences" = "#FF1493",  # Deep pink
  "Social Sciences" = "#800080"    # Purple
)

primary_domain_lu %>%
  mutate(is_lu_first_author = ifelse(is_lu_first_author, "LU-affiliated first author", "Non LU-affiliated first author")) %>%  
  ggplot(aes(
    x = publication_year,
    y = total, 
    color = primary_domain_name,
    group = primary_domain_name,
  )) +
  geom_line(linewidth = 1.2, alpha = 0.8) +
  geom_point(size = 2, alpha = 0.9) +
  scale_color_manual(values = domain_colors) +
  facet_wrap(
    ~is_lu_first_author,
    labeller = labeller(
      is_lu_first_author = c(
        "LU-affiliated first author" = "LU-affiliated first author",
        "Non LU-affiliated first author" = "Non LU-affiliated first author"
      )
    )
  ) +
  labs(
    title = "Luxembourg Research Publications by Domain Over Time",
    subtitle = "Faceted by Luxembourg First Author Status",
    x = "Publication Year",
    y = "Number of Publications",
    color = "Research Domain"
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(size = 10),
    plot.title = element_text(size = 14, face = "bold"),
    plot.subtitle = element_text(size = 12),
    legend.position = "bottom",
    legend.title = element_text(face = "bold"),
    strip.text = element_text(face = "bold", size = 11),
    strip.background = element_rect(fill = "lightgray", color = "black"),
    axis.title = element_text(size = 12),
    panel.grid.major = element_line(color = "lightgray", linewidth = 0.3),
    panel.grid.minor = element_blank()
  ) +
  # Adjust legend to show in multiple rows if needed
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

```

## International Collaboration Patterns

The analysis extends to examining Luxembourg's research collaboration patterns
with international partners. The dataset contains information about co-author
affiliations, enabling identification of the most frequent collaborating
countries and regions. This section presents the geographical distribution of
research partnerships, organized by publication year and distinguished by
Luxembourg's role as lead author versus collaborative partner.

The data processing groups countries into meaningful categories, including major
individual nations, regional blocs, and an aggregated "Others" category for
countries with lower collaboration frequencies. This approach provides clarity
while maintaining analytical depth regarding Luxembourg's primary research
partnerships:

```{r}
#| echo: false
#| warning: false
#| fig-height: 14
#| fig-width: 12

country_colors <- c(
  "European Union" = "#003399", # Deep blue (EU flag)
  "Others" = "#FF1493", # Deep pink
  "Luxembourg" = "#FF6B35", # Orange-red
  "France" = "#800080", # Purple
  "USA" = "#228B22", # Forest green
  "Belgium" = "#FFD700", # Gold
  "China" = "#DE2910", # Red
  "Great Britain" = "#C8102E", # British red (Union Jack)
  "Italy" = "#009246", # Italian green (flag)
  "Spain" = "#AA151B", # Spanish red (flag)
  "Switzerland" = "#FF0000", # Swiss red (flag)
  "Netherlands" = "#FF7F00"  # Dutch orange (national color)
)

# Plot for publication with co-authors
ggplot(country_authors_unique, aes(x = publication_year, y = n, fill = country_groups)) +
  geom_col(position = "dodge", color = "black", size = 0.5) + # Dodge bars for multiple countries per year
  scale_fill_manual(values = country_colors) +
  facet_wrap(
    ~is_lu_first_author,
    ncol = 1,
    labeller = labeller(
      is_lu_first_author = c(
        "FALSE" = "LU Not First Author",
        "TRUE" = "LU First Author"
      )
    )
  ) +
  labs(
    title = "Publications by Country/Region Over Time",
    subtitle = "Faceted by Luxembourg First Author Status",
    x = "Publication Year",
    y = "Total Publications",
    fill = "Country/Region"
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(size = 10),
    plot.title = element_text(size = 14, face = "bold"),
    plot.subtitle = element_text(size = 12),
    legend.position = "bottom",
    legend.title = element_text(face = "bold"),
    strip.text = element_text(face = "bold", size = 11),
    strip.background = element_rect(fill = "lightgray", color = "black")
  ) +
  # Adjust legend to show in multiple rows if needed
  guides(fill = guide_legend(nrow = 2, byrow = TRUE))
```
